<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Chapter Overview</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1 id="book-title">Isaiah</h1>
    <div id="chapters-container" class="grid-container"></div>

    <script src="data.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            // local data save doesn't work
            const lastBook = localStorage.getItem('lastBook');
            const lastChapter = localStorage.getItem('lastChapter');
            
            const currentBook = urlParams.get('book');
            const currentChapter = urlParams.get('chapter');

            console.log("Last Book:", lastBook, "Last Chapter:", lastChapter);
            console.log("Current Book:", currentBook, "Current Chapter:", currentChapter);

            // Only redirect if there's a mismatch and we are not on the intended page
            // if (lastBook && lastChapter && (lastBook !== currentBook || lastChapter !== currentChapter)) {
            //     console.log("Redirecting to saved chapter...");
            //     window.location.href = `chapter.html?book=${lastBook}&chapter=${lastChapter}`;
            // } else {
            //     console.log("No redirection needed.");
            // }

            const bookName = "Isaiah"; // Set this dynamically as needed
            const chapters = books[bookName]; // Ensure books data is correctly referenced
            const bookTitle = document.getElementById('book-title');
            const chaptersContainer = document.getElementById('chapters-container');

            bookTitle.textContent = bookName;

            Object.keys(chapters).forEach((chapterName) => {
                const chapterBox = document.createElement('div');
                chapterBox.className = 'chapter-box';
                chapterBox.textContent = chapterName;
                const chapterNumber = chapterName.match(/\d+/)[0]; // Extracts number from chapterName

                chapterBox.onclick = () => {
                    localStorage.setItem('lastBook', bookName);
                    localStorage.setItem('lastChapter', chapterNumber);
                    console.log("Saving and redirecting to:", bookName, chapterNumber);
                    window.location.href = `chapter.html?book=${bookName}&chapter=${chapterNumber}`;
                };
                chaptersContainer.appendChild(chapterBox);
            });
        });

    </script>
</body>
</html>
