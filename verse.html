<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verse Memorization Helper</title>
    <style>
        body, input, button {
            font-family: 'Arial', sans-serif;
            font-size: 1.25rem;
        }
        .correct { color: green; }
        .incorrect { color: red; }
        .hidden { color: white; }
        input, button {
            padding: 10px;
            margin: 5px;
            width: auto;
            display: block;
            max-width: 90%;
            box-sizing: border-box;
        }
        #verse-display {
            margin-bottom: 20px;
        }
        button {
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Verse Memorization Helper</h1>
    <p id="verse-display"></p>
    <input type="text" id="user-input" oninput="updateDisplay()" placeholder="Type here...">
    <button onclick="goToIndex()">Go to Index</button>
    <button onclick="prevVerse()">Previous Verse</button>
    <button onclick="nextVerse()">Next Verse</button>
    <button onclick="toggleMode()">Toggle Mode</button>
    <button onclick="clearInput()">Clear</button>

    <script src="data.js"></script>
    <script>
        const params = new URLSearchParams(window.location.search);
        const book = params.get('book');  // Get the book from URL
        const chapter = params.get('chapter');  // Get the chapter number from URL
        let verseIndex = parseInt(params.get('verse')) - 1;  // Get the verse index and convert to zero-based index

        let verses = books[book][`Chapter ${chapter}`];  // Assuming the structure from data.js
        let currentModeIndex = 0;
        let hideEvenWords = true;

        function updateDisplay() {
            const verseDisplay = document.getElementById('verse-display');
            verseDisplay.innerHTML = '';
            const user_input = document.getElementById('user-input').value.replace(/\s+/g, '').toLowerCase();
            const words = verses[verseIndex].split(' ');

            words.forEach((word, i) => {
                const span = document.createElement('span');
                const firstLetter = user_input[i] || '';
                span.textContent = word + ' ';
                span.className = 'hidden';
                applyVisibilityMode(span, i, firstLetter, word);
                verseDisplay.appendChild(span);
            });
        }

        function applyVisibilityMode(span, index, firstLetter, word) {
            const evenOrOdd = hideEvenWords ? index % 2 === 0 : index % 2 !== 0;
            span.className = (currentModeIndex === 1 && evenOrOdd) || currentModeIndex === 2 ? 'hidden' : '';
            if (firstLetter) {
                span.className = word[0].toLowerCase() === firstLetter ? 'correct' : 'incorrect';
            }
        }

        function prevVerse() {
            if (verseIndex > 0) verseIndex--;
            updateDisplay();
        }

        function nextVerse() {
            if (verseIndex < verses.length - 1) verseIndex++;
            updateDisplay();
        }

        function toggleMode() {
            currentModeIndex = (currentModeIndex + 1) % 3;
            updateDisplay();
        }

        function clearInput() {
            document.getElementById('user-input').value = '';
            updateDisplay();
        }

        function goToIndex() {
            window.location.href = 'index.html'; // Directs the user back to the index.html page
        }

        document.addEventListener('DOMContentLoaded', updateDisplay);
    </script>
</body>
</html>
