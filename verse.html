<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verse Memorization</title>
    <style>
        body, input, button {
            font-family: 'Arial', sans-serif;
            font-size: 1.5rem;
        }
        .correct { color: green; }
        .incorrect { color: red; }
        .hidden { color: white; }
        input, button {
            padding: 10px;
            margin: 5px;
            width: auto;
            display: inline-block;
            max-width: 90%;
            box-sizing: border-box;
        }
        #verse-display {
            cursor: pointer;
            margin-bottom: 20px;
            display: block;
        }
        #input-clear-container {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #navigation-buttons {
            text-align: center;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <h1>Verse Memorization Helper</h1>
    <p id="verse-display" onclick="goToChapter()"></p>
    <div id="input-clear-container">
        <input type="text" id="user-input" oninput="updateDisplay()" placeholder="Type here...">
        <button onclick="clearInput()">Clear</button>
    </div>
    <div id="navigation-buttons">
        <button onclick="prevVerse()">Previous Verse</button>
        <button onclick="nextVerse()">Next Verse</button>
    </div>
    <button onclick="toggleMode()" style="display: block; margin: auto;">Toggle Mode</button>

    <script src="data.js"></script>
    <script>
        const params = new URLSearchParams(window.location.search);
        const book = params.get('book');
        const chapter = params.get('chapter');
        let verseIndex = parseInt(params.get('verse')) - 1;

        let verses = books[book][`Chapter ${chapter}`];
        let currentModeIndex = 0;
        let hideEvenWords = true;

        function updateDisplay() {
            const verseDisplay = document.getElementById('verse-display');
            verseDisplay.innerHTML = '';
            const user_input = document.getElementById('user-input').value.replace(/\s+/g, '').toLowerCase();
            const words = verses[verseIndex].split(' ');

            words.forEach((word, i) => {
                const span = document.createElement('span');
                const firstLetter = user_input[i] || '';
                span.textContent = word + ' ';
                span.className = 'hidden';
                applyVisibilityMode(span, i, firstLetter, word);
                verseDisplay.appendChild(span);
            });
        }

        function applyVisibilityMode(span, index, firstLetter, word) {
            const evenOrOdd = hideEvenWords ? index % 2 === 0 : index % 2 !== 0;
            span.className = (currentModeIndex === 1 && evenOrOdd) || currentModeIndex === 2 ? 'hidden' : '';
            if (firstLetter) {
                span.className = word[0].toLowerCase() === firstLetter ? 'correct' : 'incorrect';
            }
        }

        function prevVerse() {
            if (verseIndex > 0) verseIndex--;
            updateDisplay();
        }

        function nextVerse() {
            if (verseIndex < verses.length - 1) verseIndex++;
            updateDisplay();
        }

        function toggleMode() {
            currentModeIndex = (currentModeIndex + 1) % 3;
            updateDisplay();
        }

        function clearInput() {
            document.getElementById('user-input').value = '';
            updateDisplay();
        }

        function goToChapter() {
            window.location.href = `chapter.html?book=${book}&chapter=${chapter}`;
        }


        document.addEventListener('DOMContentLoaded', updateDisplay);
    </script>
</body>
</html>
